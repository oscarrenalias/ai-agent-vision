import{s as Nt,n as at,d as u,i as L,b as a,l as b,m as It,g as T,c as v,e as C,o as O,j as A,h,p as Vt,r as Ht,q as nt,u as wt,v as Ft,a as j,f as S,t as B,w as At,x as ft,y as vt}from"../chunks/BYDQNPMj.js";import{s as ht,e as ot}from"../chunks/BhXfAO3M.js";import{S as Rt,i as Lt}from"../chunks/DGRzr_AR.js";function bt(l,t,e){const s=l.slice();return s[10]=t[e],s}function mt(l,t,e){const s=l.slice();return s[13]=t[e],s}function St(l){let t,e,s,c='<tr class="svelte-b5nbmi"><th class="svelte-b5nbmi">Date</th> <th class="svelte-b5nbmi">Store</th> <th class="svelte-b5nbmi">Total</th> <th class="svelte-b5nbmi">Items</th> <th class="svelte-b5nbmi">Savings</th> <th class="svelte-b5nbmi">Actions</th></tr>',o,n,f=ot(l[0]),_=[];for(let r=0;r<f.length;r+=1)_[r]=pt(mt(l,f,r));return{c(){t=h("div"),e=h("table"),s=h("thead"),s.innerHTML=c,o=A(),n=h("tbody");for(let r=0;r<_.length;r+=1)_[r].c();this.h()},l(r){t=v(r,"DIV",{class:!0});var d=C(t);e=v(d,"TABLE",{class:!0});var i=C(e);s=v(i,"THEAD",{"data-svelte-h":!0}),O(s)!=="svelte-1imfsko"&&(s.innerHTML=c),o=T(i),n=v(i,"TBODY",{});var m=C(n);for(let y=0;y<_.length;y+=1)_[y].l(m);m.forEach(u),i.forEach(u),d.forEach(u),this.h()},h(){b(e,"class","svelte-b5nbmi"),b(t,"class","receipts-list")},m(r,d){L(r,t,d),a(t,e),a(e,s),a(e,o),a(e,n);for(let i=0;i<_.length;i+=1)_[i]&&_[i].m(n,null)},p(r,d){if(d&33){f=ot(r[0]);let i;for(i=0;i<f.length;i+=1){const m=mt(r,f,i);_[i]?_[i].p(m,d):(_[i]=pt(m),_[i].c(),_[i].m(n,null))}for(;i<_.length;i+=1)_[i].d(1);_.length=f.length}},d(r){r&&u(t),At(_,r)}}}function Bt(l){let t,e='<p>No receipts found. Upload a receipt to get started.</p> <a href="/receipts" class="button svelte-b5nbmi">Upload Receipt</a>';return{c(){t=h("div"),t.innerHTML=e,this.h()},l(s){t=v(s,"DIV",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-h0b2qi"&&(t.innerHTML=e),this.h()},h(){b(t,"class","empty-state svelte-b5nbmi")},m(s,c){L(s,t,c)},p:at,d(s){s&&u(t)}}}function qt(l){let t,e,s,c,o="Retry",n,f;return{c(){t=h("div"),e=B(l[2]),s=A(),c=h("button"),c.textContent=o,this.h()},l(_){t=v(_,"DIV",{class:!0});var r=C(t);e=S(r,l[2]),s=T(r),c=v(r,"BUTTON",{class:!0,"data-svelte-h":!0}),O(c)!=="svelte-1wo6ea3"&&(c.textContent=o),r.forEach(u),this.h()},h(){b(c,"class","retry-button svelte-b5nbmi"),b(t,"class","error-message svelte-b5nbmi")},m(_,r){L(_,t,r),a(t,e),a(t,s),a(t,c),n||(f=nt(c,"click",l[4]),n=!0)},p(_,r){r&4&&j(e,_[2])},d(_){_&&u(t),n=!1,f()}}}function Mt(l){let t,e="Loading receipts...";return{c(){t=h("div"),t.textContent=e,this.h()},l(s){t=v(s,"DIV",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-a53n8u"&&(t.textContent=e),this.h()},h(){b(t,"class","loading svelte-b5nbmi")},m(s,c){L(s,t,c)},p:at,d(s){s&&u(t)}}}function Pt(l){let t;return{c(){t=B("€0.00")},l(e){t=S(e,"€0.00")},m(e,s){L(e,t,s)},p:at,d(e){e&&u(t)}}}function Ut(l){let t,e=ct(l[13].data.items).toFixed(2)+"",s;return{c(){t=B("€"),s=B(e)},l(c){t=S(c,"€"),s=S(c,e)},m(c,o){L(c,t,o),L(c,s,o)},p(c,o){o&1&&e!==(e=ct(c[13].data.items).toFixed(2)+"")&&j(s,e)},d(c){c&&(u(t),u(s))}}}function pt(l){var Q,K,et,tt,W,X;let t,e,s=Et(l[13].created_at)+"",c,o,n,f=(((K=(Q=l[13].data)==null?void 0:Q.receipt_data)==null?void 0:K.place)||"N/A")+"",_,r,d,i=(tt=(et=l[13].data)==null?void 0:et.receipt_data)!=null&&tt.total?`€${l[13].data.receipt_data.total.toFixed(2)}`:"N/A",m,y,p,k=(((X=(W=l[13].data)==null?void 0:W.items)==null?void 0:X.length)||0)+"",E,Y,M,N,R,P,g,I="View",H,w,$;function z(G,V){var U;return(U=G[13].data)!=null&&U.items?Ut:Pt}let q=z(l),D=q(l);function F(){return l[8](l[13])}return{c(){t=h("tr"),e=h("td"),c=B(s),o=A(),n=h("td"),_=B(f),r=A(),d=h("td"),m=B(i),y=A(),p=h("td"),E=B(k),Y=B(" items"),M=A(),N=h("td"),D.c(),R=A(),P=h("td"),g=h("button"),g.textContent=I,H=A(),this.h()},l(G){t=v(G,"TR",{class:!0});var V=C(t);e=v(V,"TD",{class:!0});var U=C(e);c=S(U,s),U.forEach(u),o=T(V),n=v(V,"TD",{class:!0});var lt=C(n);_=S(lt,f),lt.forEach(u),r=T(V),d=v(V,"TD",{class:!0});var J=C(d);m=S(J,i),J.forEach(u),y=T(V),p=v(V,"TD",{class:!0});var Z=C(p);E=S(Z,k),Y=S(Z," items"),Z.forEach(u),M=T(V),N=v(V,"TD",{class:!0});var st=C(N);D.l(st),st.forEach(u),R=T(V),P=v(V,"TD",{class:!0});var x=C(P);g=v(x,"BUTTON",{class:!0,"data-svelte-h":!0}),O(g)!=="svelte-sdwps"&&(g.textContent=I),x.forEach(u),H=T(V),V.forEach(u),this.h()},h(){b(e,"class","svelte-b5nbmi"),b(n,"class","svelte-b5nbmi"),b(d,"class","svelte-b5nbmi"),b(p,"class","svelte-b5nbmi"),b(N,"class","svelte-b5nbmi"),b(g,"class","view-button svelte-b5nbmi"),b(P,"class","svelte-b5nbmi"),b(t,"class","svelte-b5nbmi")},m(G,V){L(G,t,V),a(t,e),a(e,c),a(t,o),a(t,n),a(n,_),a(t,r),a(t,d),a(d,m),a(t,y),a(t,p),a(p,E),a(p,Y),a(t,M),a(t,N),D.m(N,null),a(t,R),a(t,P),a(P,g),a(t,H),w||($=nt(g,"click",F),w=!0)},p(G,V){var U,lt,J,Z,st,x;l=G,V&1&&s!==(s=Et(l[13].created_at)+"")&&j(c,s),V&1&&f!==(f=(((lt=(U=l[13].data)==null?void 0:U.receipt_data)==null?void 0:lt.place)||"N/A")+"")&&j(_,f),V&1&&i!==(i=(Z=(J=l[13].data)==null?void 0:J.receipt_data)!=null&&Z.total?`€${l[13].data.receipt_data.total.toFixed(2)}`:"N/A")&&j(m,i),V&1&&k!==(k=(((x=(st=l[13].data)==null?void 0:st.items)==null?void 0:x.length)||0)+"")&&j(E,k),q===(q=z(l))&&D?D.p(l,V):(D.d(1),D=q(l),D&&(D.c(),D.m(N,null)))},d(G){G&&u(t),D.d(),w=!1,$()}}}function yt(l){var R,P;let t,e,s,c,o="Receipt Details",n,f,_="×",r,d,i,m,y,p,k=((R=l[3].data)==null?void 0:R.receipt_data)&&kt(l),E=((P=l[3].data)==null?void 0:P.items)&&l[3].data.items.length>0&&gt(l);function Y(g,I){var H;return(H=g[3].data)!=null&&H.items&&g[3].data.items.length>0?jt:Ot}let M=Y(l),N=M(l);return{c(){t=h("div"),e=h("div"),s=h("div"),c=h("h2"),c.textContent=o,n=A(),f=h("button"),f.textContent=_,r=A(),d=h("div"),k&&k.c(),i=A(),E&&E.c(),m=A(),N.c(),this.h()},l(g){t=v(g,"DIV",{class:!0,role:!0,"aria-modal":!0});var I=C(t);e=v(I,"DIV",{class:!0});var H=C(e);s=v(H,"DIV",{class:!0});var w=C(s);c=v(w,"H2",{class:!0,"data-svelte-h":!0}),O(c)!=="svelte-17l158w"&&(c.textContent=o),n=T(w),f=v(w,"BUTTON",{class:!0,"data-svelte-h":!0}),O(f)!=="svelte-1m73dop"&&(f.textContent=_),w.forEach(u),r=T(H),d=v(H,"DIV",{class:!0});var $=C(d);k&&k.l($),i=T($),E&&E.l($),m=T($),N.l($),$.forEach(u),H.forEach(u),I.forEach(u),this.h()},h(){b(c,"class","svelte-b5nbmi"),b(f,"class","close-button svelte-b5nbmi"),b(s,"class","modal-header svelte-b5nbmi"),b(d,"class","modal-body svelte-b5nbmi"),b(e,"class","modal-content svelte-b5nbmi"),b(t,"class","modal-overlay svelte-b5nbmi"),b(t,"role","dialog"),b(t,"aria-modal","true")},m(g,I){L(g,t,I),a(t,e),a(e,s),a(s,c),a(s,n),a(s,f),a(e,r),a(e,d),k&&k.m(d,null),a(d,i),E&&E.m(d,null),a(d,m),N.m(d,null),y||(p=[nt(f,"click",l[6]),nt(e,"click",wt(l[7])),nt(t,"click",l[6]),nt(t,"keydown",l[9])],y=!0)},p(g,I){var H,w;(H=g[3].data)!=null&&H.receipt_data?k?k.p(g,I):(k=kt(g),k.c(),k.m(d,i)):k&&(k.d(1),k=null),(w=g[3].data)!=null&&w.items&&g[3].data.items.length>0?E?E.p(g,I):(E=gt(g),E.c(),E.m(d,m)):E&&(E.d(1),E=null),M===(M=Y(g))&&N?N.p(g,I):(N.d(1),N=M(g),N&&(N.c(),N.m(d,null)))},d(g){g&&u(t),k&&k.d(),E&&E.d(),N.d(),y=!1,Ht(p)}}}function kt(l){let t,e,s="Receipt Summary",c,o,n,f,_,r="Date",d,i,m=(l[3].data.receipt_data.date||"N/A")+"",y,p,k,E,Y="Place",M,N,R=(l[3].data.receipt_data.place||"N/A")+"",P,g,I,H,w="Total",$,z,q=l[3].data.receipt_data.total?`€${l[3].data.receipt_data.total.toFixed(2)}`:"N/A",D,F,Q,K,et="Total Savings",tt,W,X=(l[3].data.receipt_data.total_savings||"N/A")+"",G;return{c(){t=h("div"),e=h("h3"),e.textContent=s,c=A(),o=h("table"),n=h("tbody"),f=h("tr"),_=h("th"),_.textContent=r,d=A(),i=h("td"),y=B(m),p=A(),k=h("tr"),E=h("th"),E.textContent=Y,M=A(),N=h("td"),P=B(R),g=A(),I=h("tr"),H=h("th"),H.textContent=w,$=A(),z=h("td"),D=B(q),F=A(),Q=h("tr"),K=h("th"),K.textContent=et,tt=A(),W=h("td"),G=B(X),this.h()},l(V){t=v(V,"DIV",{class:!0});var U=C(t);e=v(U,"H3",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-1cqlgwa"&&(e.textContent=s),c=T(U),o=v(U,"TABLE",{class:!0});var lt=C(o);n=v(lt,"TBODY",{});var J=C(n);f=v(J,"TR",{class:!0});var Z=C(f);_=v(Z,"TH",{class:!0,"data-svelte-h":!0}),O(_)!=="svelte-1vf788i"&&(_.textContent=r),d=T(Z),i=v(Z,"TD",{class:!0});var st=C(i);y=S(st,m),st.forEach(u),Z.forEach(u),p=T(J),k=v(J,"TR",{class:!0});var x=C(k);E=v(x,"TH",{class:!0,"data-svelte-h":!0}),O(E)!=="svelte-cjzgdb"&&(E.textContent=Y),M=T(x),N=v(x,"TD",{class:!0});var dt=C(N);P=S(dt,R),dt.forEach(u),x.forEach(u),g=T(J),I=v(J,"TR",{class:!0});var it=C(I);H=v(it,"TH",{class:!0,"data-svelte-h":!0}),O(H)!=="svelte-3jponc"&&(H.textContent=w),$=T(it),z=v(it,"TD",{class:!0});var ut=C(z);D=S(ut,q),ut.forEach(u),it.forEach(u),F=T(J),Q=v(J,"TR",{class:!0});var rt=C(Q);K=v(rt,"TH",{class:!0,"data-svelte-h":!0}),O(K)!=="svelte-lo4fxt"&&(K.textContent=et),tt=T(rt),W=v(rt,"TD",{class:!0});var _t=C(W);G=S(_t,X),_t.forEach(u),rt.forEach(u),J.forEach(u),lt.forEach(u),U.forEach(u),this.h()},h(){b(e,"class","svelte-b5nbmi"),b(_,"class","svelte-b5nbmi"),b(i,"class","svelte-b5nbmi"),b(f,"class","svelte-b5nbmi"),b(E,"class","svelte-b5nbmi"),b(N,"class","svelte-b5nbmi"),b(k,"class","svelte-b5nbmi"),b(H,"class","svelte-b5nbmi"),b(z,"class","svelte-b5nbmi"),b(I,"class","svelte-b5nbmi"),b(K,"class","svelte-b5nbmi"),b(W,"class","svelte-b5nbmi"),b(Q,"class","svelte-b5nbmi"),b(o,"class","svelte-b5nbmi"),b(t,"class","receipt-summary svelte-b5nbmi")},m(V,U){L(V,t,U),a(t,e),a(t,c),a(t,o),a(o,n),a(n,f),a(f,_),a(f,d),a(f,i),a(i,y),a(n,p),a(n,k),a(k,E),a(k,M),a(k,N),a(N,P),a(n,g),a(n,I),a(I,H),a(I,$),a(I,z),a(z,D),a(n,F),a(n,Q),a(Q,K),a(Q,tt),a(Q,W),a(W,G)},p(V,U){U&8&&m!==(m=(V[3].data.receipt_data.date||"N/A")+"")&&j(y,m),U&8&&R!==(R=(V[3].data.receipt_data.place||"N/A")+"")&&j(P,R),U&8&&q!==(q=V[3].data.receipt_data.total?`€${V[3].data.receipt_data.total.toFixed(2)}`:"N/A")&&j(D,q),U&8&&X!==(X=(V[3].data.receipt_data.total_savings||"N/A")+"")&&j(G,X)},d(V){V&&u(t)}}}function gt(l){let t,e,s="Loyalty Discount Summary",c,o,n,f,_=Tt(l[3].data.items)+"",r,d,i,m="Items with Discounts",y,p,k,E,Y=ct(l[3].data.items).toFixed(2)+"",M,N,R,P="Total Savings";return{c(){t=h("div"),e=h("h3"),e.textContent=s,c=A(),o=h("div"),n=h("div"),f=h("div"),r=B(_),d=A(),i=h("div"),i.textContent=m,y=A(),p=h("div"),k=h("div"),E=B("€"),M=B(Y),N=A(),R=h("div"),R.textContent=P,this.h()},l(g){t=v(g,"DIV",{class:!0});var I=C(t);e=v(I,"H3",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-1cw25gd"&&(e.textContent=s),c=T(I),o=v(I,"DIV",{class:!0});var H=C(o);n=v(H,"DIV",{class:!0});var w=C(n);f=v(w,"DIV",{class:!0});var $=C(f);r=S($,_),$.forEach(u),d=T(w),i=v(w,"DIV",{class:!0,"data-svelte-h":!0}),O(i)!=="svelte-ci553k"&&(i.textContent=m),w.forEach(u),y=T(H),p=v(H,"DIV",{class:!0});var z=C(p);k=v(z,"DIV",{class:!0});var q=C(k);E=S(q,"€"),M=S(q,Y),q.forEach(u),N=T(z),R=v(z,"DIV",{class:!0,"data-svelte-h":!0}),O(R)!=="svelte-13gevvv"&&(R.textContent=P),z.forEach(u),H.forEach(u),I.forEach(u),this.h()},h(){b(e,"class","svelte-b5nbmi"),b(f,"class","summary-value svelte-b5nbmi"),b(i,"class","summary-label svelte-b5nbmi"),b(n,"class","summary-card svelte-b5nbmi"),b(k,"class","summary-value svelte-b5nbmi"),b(R,"class","summary-label svelte-b5nbmi"),b(p,"class","summary-card highlight svelte-b5nbmi"),b(o,"class","summary-cards svelte-b5nbmi"),b(t,"class","loyalty-summary svelte-b5nbmi")},m(g,I){L(g,t,I),a(t,e),a(t,c),a(t,o),a(o,n),a(n,f),a(f,r),a(n,d),a(n,i),a(o,y),a(o,p),a(p,k),a(k,E),a(k,M),a(p,N),a(p,R)},p(g,I){I&8&&_!==(_=Tt(g[3].data.items)+"")&&j(r,_),I&8&&Y!==(Y=ct(g[3].data.items).toFixed(2)+"")&&j(M,Y)},d(g){g&&u(t)}}}function Ot(l){let t,e="No items found in the receipt.";return{c(){t=h("p"),t.textContent=e},l(s){t=v(s,"P",{"data-svelte-h":!0}),O(t)!=="svelte-7gs42n"&&(t.textContent=e)},m(s,c){L(s,t,c)},p:at,d(s){s&&u(t)}}}function jt(l){let t,e,s="Receipt Items",c,o,n,f='<tr class="svelte-b5nbmi"><th class="svelte-b5nbmi">Item</th> <th class="svelte-b5nbmi">Quantity</th> <th class="svelte-b5nbmi">Unit Price</th> <th class="svelte-b5nbmi">Total Price</th> <th class="svelte-b5nbmi">Loyalty Discount</th> <th class="svelte-b5nbmi">Category</th></tr>',_,r,d=ot(l[3].data.items),i=[];for(let m=0;m<d.length;m+=1)i[m]=Dt(bt(l,d,m));return{c(){t=h("div"),e=h("h3"),e.textContent=s,c=A(),o=h("table"),n=h("thead"),n.innerHTML=f,_=A(),r=h("tbody");for(let m=0;m<i.length;m+=1)i[m].c();this.h()},l(m){t=v(m,"DIV",{class:!0});var y=C(t);e=v(y,"H3",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-v4hn3y"&&(e.textContent=s),c=T(y),o=v(y,"TABLE",{class:!0});var p=C(o);n=v(p,"THEAD",{"data-svelte-h":!0}),O(n)!=="svelte-fkdzdk"&&(n.innerHTML=f),_=T(p),r=v(p,"TBODY",{});var k=C(r);for(let E=0;E<i.length;E+=1)i[E].l(k);k.forEach(u),p.forEach(u),y.forEach(u),this.h()},h(){b(e,"class","svelte-b5nbmi"),b(o,"class","svelte-b5nbmi"),b(t,"class","receipt-items svelte-b5nbmi")},m(m,y){L(m,t,y),a(t,e),a(t,c),a(t,o),a(o,n),a(o,_),a(o,r);for(let p=0;p<i.length;p+=1)i[p]&&i[p].m(r,null)},p(m,y){if(y&8){d=ot(m[3].data.items);let p;for(p=0;p<d.length;p+=1){const k=bt(m,d,p);i[p]?i[p].p(k,y):(i[p]=Dt(k),i[p].c(),i[p].m(r,null))}for(;p<i.length;p+=1)i[p].d(1);i.length=d.length}},d(m){m&&u(t),At(i,m)}}}function Yt(l){let t;return{c(){t=B("-")},l(e){t=S(e,"-")},m(e,s){L(e,t,s)},p:at,d(e){e&&u(t)}}}function $t(l){let t,e="Yes",s,c,o=l[10].loyalty_discount&&Ct(l);return{c(){t=h("span"),t.textContent=e,s=A(),o&&o.c(),c=vt(),this.h()},l(n){t=v(n,"SPAN",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-120ladd"&&(t.textContent=e),s=T(n),o&&o.l(n),c=vt(),this.h()},h(){b(t,"class","discount-badge svelte-b5nbmi")},m(n,f){L(n,t,f),L(n,s,f),o&&o.m(n,f),L(n,c,f)},p(n,f){n[10].loyalty_discount?o?o.p(n,f):(o=Ct(n),o.c(),o.m(c.parentNode,c)):o&&(o.d(1),o=null)},d(n){n&&(u(t),u(s),u(c)),o&&o.d(n)}}}function Ct(l){let t,e,s=l[10].loyalty_discount.toFixed(2)+"",c;return{c(){t=h("span"),e=B("€"),c=B(s),this.h()},l(o){t=v(o,"SPAN",{class:!0});var n=C(t);e=S(n,"€"),c=S(n,s),n.forEach(u),this.h()},h(){b(t,"class","discount-amount svelte-b5nbmi")},m(o,n){L(o,t,n),a(t,e),a(t,c)},p(o,n){n&8&&s!==(s=o[10].loyalty_discount.toFixed(2)+"")&&j(c,s)},d(o){o&&u(t)}}}function zt(l){let t;return{c(){t=B("N/A")},l(e){t=S(e,"N/A")},m(e,s){L(e,t,s)},p:at,d(e){e&&u(t)}}}function Qt(l){let t=(l[10].item_category.level_1||"")+"",e,s,c=l[10].item_category.level_2?`> ${l[10].item_category.level_2}`:"",o,n,f=l[10].item_category.level_3?`> ${l[10].item_category.level_3}`:"",_;return{c(){e=B(t),s=A(),o=B(c),n=A(),_=B(f)},l(r){e=S(r,t),s=T(r),o=S(r,c),n=T(r),_=S(r,f)},m(r,d){L(r,e,d),L(r,s,d),L(r,o,d),L(r,n,d),L(r,_,d)},p(r,d){d&8&&t!==(t=(r[10].item_category.level_1||"")+"")&&j(e,t),d&8&&c!==(c=r[10].item_category.level_2?`> ${r[10].item_category.level_2}`:"")&&j(o,c),d&8&&f!==(f=r[10].item_category.level_3?`> ${r[10].item_category.level_3}`:"")&&j(_,f)},d(r){r&&(u(e),u(s),u(o),u(n),u(_))}}}function Dt(l){let t,e,s=(l[10].name_en||l[10].name_fi||"N/A")+"",c,o,n,f=l[10].quantity?`${l[10].quantity} ${l[10].unit_of_measure||""}`:"N/A",_,r,d,i=l[10].unit_price?`€${l[10].unit_price.toFixed(2)}`:"N/A",m,y,p,k=l[10].total_price?`€${l[10].total_price.toFixed(2)}`:"N/A",E,Y,M,N,R,P,g;function I(D,F){return D[10].has_loyalty_discount?$t:Yt}let H=I(l),w=H(l);function $(D,F){return D[10].item_category?Qt:zt}let z=$(l),q=z(l);return{c(){t=h("tr"),e=h("td"),c=B(s),o=A(),n=h("td"),_=B(f),r=A(),d=h("td"),m=B(i),y=A(),p=h("td"),E=B(k),Y=A(),M=h("td"),w.c(),N=A(),R=h("td"),q.c(),P=A(),this.h()},l(D){t=v(D,"TR",{class:!0});var F=C(t);e=v(F,"TD",{class:!0});var Q=C(e);c=S(Q,s),Q.forEach(u),o=T(F),n=v(F,"TD",{class:!0});var K=C(n);_=S(K,f),K.forEach(u),r=T(F),d=v(F,"TD",{class:!0});var et=C(d);m=S(et,i),et.forEach(u),y=T(F),p=v(F,"TD",{class:!0});var tt=C(p);E=S(tt,k),tt.forEach(u),Y=T(F),M=v(F,"TD",{class:!0});var W=C(M);w.l(W),W.forEach(u),N=T(F),R=v(F,"TD",{class:!0});var X=C(R);q.l(X),X.forEach(u),P=T(F),F.forEach(u),this.h()},h(){b(e,"class","svelte-b5nbmi"),b(n,"class","svelte-b5nbmi"),b(d,"class","svelte-b5nbmi"),b(p,"class","svelte-b5nbmi"),b(M,"class","svelte-b5nbmi"),b(R,"class","svelte-b5nbmi"),b(t,"class",g=ft(l[10].has_loyalty_discount?"has-discount":"")+" svelte-b5nbmi")},m(D,F){L(D,t,F),a(t,e),a(e,c),a(t,o),a(t,n),a(n,_),a(t,r),a(t,d),a(d,m),a(t,y),a(t,p),a(p,E),a(t,Y),a(t,M),w.m(M,null),a(t,N),a(t,R),q.m(R,null),a(t,P)},p(D,F){F&8&&s!==(s=(D[10].name_en||D[10].name_fi||"N/A")+"")&&j(c,s),F&8&&f!==(f=D[10].quantity?`${D[10].quantity} ${D[10].unit_of_measure||""}`:"N/A")&&j(_,f),F&8&&i!==(i=D[10].unit_price?`€${D[10].unit_price.toFixed(2)}`:"N/A")&&j(m,i),F&8&&k!==(k=D[10].total_price?`€${D[10].total_price.toFixed(2)}`:"N/A")&&j(E,k),H===(H=I(D))&&w?w.p(D,F):(w.d(1),w=H(D),w&&(w.c(),w.m(M,null))),z===(z=$(D))&&q?q.p(D,F):(q.d(1),q=z(D),q&&(q.c(),q.m(R,null))),F&8&&g!==(g=ft(D[10].has_loyalty_discount?"has-discount":"")+" svelte-b5nbmi")&&b(t,"class",g)},d(D){D&&u(t),w.d(),q.d()}}}function Gt(l){let t,e,s,c="Receipt History",o,n;function f(i,m){return i[1]?Mt:i[2]?qt:i[0].length===0?Bt:St}let _=f(l),r=_(l),d=l[3]&&yt(l);return{c(){t=A(),e=h("div"),s=h("h1"),s.textContent=c,o=A(),r.c(),n=A(),d&&d.c(),this.h()},l(i){It("svelte-1fj28en",document.head).forEach(u),t=T(i),e=v(i,"DIV",{class:!0});var y=C(e);s=v(y,"H1",{class:!0,"data-svelte-h":!0}),O(s)!=="svelte-1u8g2ga"&&(s.textContent=c),o=T(y),r.l(y),n=T(y),d&&d.l(y),y.forEach(u),this.h()},h(){document.title="AI Agent Vision - Receipt History",b(s,"class","svelte-b5nbmi"),b(e,"class","receipt-history svelte-b5nbmi")},m(i,m){L(i,t,m),L(i,e,m),a(e,s),a(e,o),r.m(e,null),a(e,n),d&&d.m(e,null)},p(i,[m]){_===(_=f(i))&&r?r.p(i,m):(r.d(1),r=_(i),r&&(r.c(),r.m(e,n))),i[3]?d?d.p(i,m):(d=yt(i),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},i:at,o:at,d(i){i&&(u(t),u(e)),r.d(),d&&d.d()}}}function Et(l){try{const t=new Date(l);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}catch{return l}}function ct(l){return!l||!Array.isArray(l)?0:l.reduce((t,e)=>e.has_loyalty_discount&&e.loyalty_discount?t+parseFloat(e.loyalty_discount):t,0)}function Tt(l){return!l||!Array.isArray(l)?0:l.filter(t=>t.has_loyalty_discount).length}function Jt(l,t,e){let s=[],c=!0,o=null,n=null;async function f(){e(1,c=!0),e(2,o=null);try{const p=await(await fetch("/api/receipts")).json();p.status==="success"?e(0,s=p.receipts):e(2,o=p.error||"Failed to load receipts")}catch(y){e(2,o="Error loading receipts: "+(y instanceof Error?y.message:String(y)))}finally{e(1,c=!1)}}function _(y){e(3,n=y),ht(y)}function r(){e(3,n=null),ht(null)}Vt(()=>{f()});function d(y){Ft.call(this,l,y)}return[s,c,o,n,f,_,r,d,y=>_(y),y=>y.key==="Escape"&&r()]}class Zt extends Rt{constructor(t){super(),Lt(this,t,Jt,Gt,Nt,{})}}export{Zt as component};
